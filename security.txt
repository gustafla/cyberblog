LINK: https://github.com/gustafla/cyberblog

FLAW 1:
https://github.com/gustafla/cyberblog/blob/master/blog/templates/blog/view.html#L11
https://github.com/gustafla/cyberblog/blob/master/blog/views.py#L28
Cross-site Scripting Vulnerability.
The blog allows all posts by users to be shown more or less as it was received
(using the django template safe tag). The application does not manually protect
against HTML tags, which results in the users who can write posts to be able to
add <scipt> tags to their posts.
This flaw can be fixed by removing the safe tag from the view.html template.
Paragraph splits can be safely added by parsing the post text in the view -view
into a list of paragraphs, and using the template engine's for loop to iterate
over the list, inserting each paragraph into a <p> element.

FLAW 2:
https://github.com/gustafla/cyberblog/blob/master/blog/views.py#L39
Cross-site Request Forgery.
By marking the create_post view with the csrf_exempt decorator, Django does not
require a CSRF protection cookie. This enables a malicious site to trick the
user into writing a blog post on the cyberblog site.
Here's an example of what an exploit page could look like:
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>CONGRATULATIONS!</title>
    <!-- A READY TO RUN VERSION OF THIS IS PROVIDED IN THE csrf_exploit DIRECTORY -->
  </head>
  <body>
    <h1>CONGRATULATIONS YOU HAVE WON $ 1,000,000</h1>
    <p>Just fill out the form below to claim your prize! Include your Full
    Name, Address, Phone Number, Social Security Number and Email Address.</p>
    <form method="GET" action="http://127.0.0.1:8000/blog/create/">
      <input type="hidden" id="title" name="title" value="I GOT DOXED" /><br />
      <textarea id="text" name="text" style="height: 200px; width: 400px"></textarea><br />
      <input type="submit" value="Claim $1,000,000">
    </form>
  </body>
</html>
This flaw can be fixed by removing the csrf_exempt decorator and adding a
csrf_token in the form in the post.html -template. Also, a good practice would
be to only accept new posts to be posted with the POST-method.

FLAW 3:
https://github.com/gustafla/cyberblog/blob/master/accounts/views.py#L18
https://github.com/gustafla/cyberblog/blob/master/accounts/views.py#L21
Weak authentication.
The blog account registration requires passwords to be 8 or fewer alphanumeric
characters, and treats them as case-insensitive. This flaw makes the user
accounts vulnerable to brute force attacks and the passwords become especially
compromised if the database gets leaked. The registration and login pages don't
have protection against brute force attacks.
This can be fixed by changing password requirements to require longer
passwords, removing the .lower() calls which make the passwords
case-insensitive, and/or by adding mandatory multi-factor authentication. The
registration and login pages can be protected against bots and brute force
attacks by adding counters and timeouts, and captchas.

FLAW 4:
https://github.com/gustafla/cyberblog/blob/master/accounts/views.py#L13
https://github.com/gustafla/cyberblog/blob/master/accounts/views.py#L41
Misconfigured security headers.
Some pages, such as the registration and login should have the header
X-Frame-Options configured to disallow embedding on other sites. This could
potentially lead to user authentication information leaking to attackers.
This can be fixed by removing all the xframe_options_exempt decorators.

FLAW 5:
